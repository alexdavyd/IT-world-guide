## React Native

React Native — это фреймворк с открытым исходным кодом, созданный компанией Meta (ранее Facebook) для разработки 
мобильных приложений под iOS и Android с использованием JavaScript и библиотеки React. Вместо того чтобы писать два 
отдельных приложения на Swift/Objective-C (iOS) и Kotlin/Java (Android), разработчики могут создавать единую кодовую 
базу на JavaScript, которая затем «превращается» в полноценные нативные приложения.

React Native сочетает лучшие стороны веб-разработки (быстрый цикл итераций, декларативный UI) с производительностью и 
возможностями нативных платформ. Приложения, написанные на React Native, выглядят и работают так же, как созданные 
традиционным способом, потому что они используют настоящие нативные компоненты, а не WebView 
(как, например, Cordova или Ionic).

## Как работает React Native?

Ключевая идея React Native — наличие **моста (bridge)** между JavaScript-кодом и нативной средой выполнения.

1.  **JavaScript-поток (JS Thread)** — здесь выполняется вся логика приложения, написанная на JavaScript/React. Этот поток работает в отдельном движке (например, JavaScriptCore на iOS или Hermes — собственный движок Meta).
2.  **Нативный поток (Native Thread)** — главный поток платформы (iOS/Android), отвечающий за отрисовку UI, обработку жестов и вызовы API.
3.  **Мост (Bridge)** — асинхронный канал связи между JS и нативным потоками. Когда в JavaScript-коде меняется состояние компонента, через мост передаётся сериализованное сообщение о том, какой нативный компонент и как нужно обновить. Нативная сторона получает это сообщение и применяет изменения к реальным UI-элементам (например, `UIView` на iOS или `ViewGroup` на Android).

Благодаря такому подходу разработчик пишет компоненты на JavaScript (например, `<View>`, `<Text>`, `<ScrollView>`), а React Native преобразует их в соответствующие нативные элементы. При этом не нужно заново компилировать всё приложение при каждом изменении кода — работает горячая перезагрузка (Fast Refresh), что сильно ускоряет разработку.

## Ключевые принципы и особенности

- **React-подход** — всё строится на компонентах с собственным состоянием (state) и свойствами (props). Используется JSX (расширение синтаксиса JavaScript) для описания интерфейса.
- **"Learn once, write anywhere"** — не нужно изучать Swift и Kotlin по отдельности; достаточно знать React и JavaScript. Однако под каждую платформу иногда требуется адаптировать логику или стили (например, обрабатывать разные жесты или системные особенности).
- **Нативные модули** — если стандартных компонентов недостаточно, можно писать свои нативные модули на Java/Kotlin или Swift/Objective-C и вызывать их из JavaScript. Это позволяет использовать любые возможности устройства (камера, Bluetooth, датчики).
- **Стилизация** — используется подмножество CSS (Flexbox) через объекты JavaScript, что упрощает верстку и делает её знакомой веб-разработчикам.

## Преимущества React Native

- **Быстрая разработка и итерации** — единая кодовая база для двух платформ, горячая перезагрузка, огромная экосистема готовых компонентов (npm).
- **Экономия ресурсов** — не нужно держать две команды мобильных разработчиков; веб-разработчики могут быстро переключиться на мобильную разработку.
- **Большое сообщество** — множество библиотек, инструментов, хорошая документация, поддержка со стороны Meta.
- **Производительность, близкая к нативной** — благодаря использованию настоящих нативных компонентов, приложения работают быстро и отзывчиво (особенно с новой архитектурой Fabric).
- **Возможность постепенного внедрения** — можно добавить React Native в существующее нативное приложение для отдельных экранов или фич (например, так сделали в Instagram).

## Недостатки и ограничения

- **Производительность сложных анимаций** — старый мост (bridge) может создавать задержки при интенсивной анимации, потому что каждый кадр требует передачи данных между JS и нативой. Новая архитектура (Fabric и TurboModules) решает эту проблему, но её внедрение требует времени.
- **Размер приложения** — даже пустое React Native-приложение весит больше, чем нативное (из-за встроенного JS-движка и базовых библиотек). Однако это частично компенсируется использованием Hermes.
- **Зависимость от моста** — любые взаимодействия с нативными API (например, доступ к файловой системе) происходят асинхронно, что усложняет некоторые сценарии.
- **Обновления и совместимость** — частые изменения в React Native могут требовать адаптации кода, а новые версии iOS/Android иногда ломают обратную совместимость сторонних библиотек.
- **Не всё можно сделать на JavaScript** — для сложных интеграций с устройством всё равно приходится писать нативный код, что требует знания соответствующих языков.

## История и текущее состояние

React Native был представлен Facebook в 2015 году на конференции React.js Conf и быстро набрал популярность. Изначально он использовался внутри Facebook для мобильного приложения (например, в Facebook Ads Manager), а позже стал открытым проектом.

Сегодня React Native используют тысячи компаний: **Instagram, Facebook, Discord, Shopify, Tesla, UberEats, Pinterest, Wix** и многие другие. Сообщество активно развивает экосистему, а команда React Native постоянно улучшает фреймворк.

**Новая архитектура** (React Native 0.68+):
- **Fabric** — новый рендерер, который синхронизирует JS и нативный UI более эффективно.
- **TurboModules** — позволяют лениво загружать нативные модули и уменьшают время старта.
- **Codegen** — генерирует типы для безопасного взаимодействия между JS и нативой.
- **Hermes** — оптимизированный JS-движок, который уменьшает размер и ускоряет запуск.

## Пример использования в Instagram

Как упоминалось в [статье об архитектуре Instagram](../cases/instagram.md), компания использует React Native для 
некоторых частей своего приложения. Instagram не полностью переписан на React Native, но активно применяет его для 
ускорения разработки фич, которые не требуют глубокой интеграции с нативным кодом. Например, экран настроек, 
страницы профиля, лента Reels (частично) могут быть реализованы с помощью React Native. Это позволяет командам быстро 
экспериментировать и выкатывать обновления, не дожидаясь синхронных релизов двух платформ.

Instagram даже делилась опытом: использование React Native позволило им увеличить скорость разработки и сократить время 
вывода новых функций, сохранив при этом высокое качество и плавность интерфейса.

## Заключение

React Native — это мощный и зрелый фреймворк, который занимает важное место в мире мобильной разработки. 
Он идеально подходит для стартапов, продуктов с ограниченными ресурсами или компаний, стремящихся к быстрым итерациям. 
Благодаря постоянному развитию и поддержке крупных игроков, React Native остаётся одним из лучших вариантов 
кроссплатформенной разработки, позволяя создавать качественные приложения, которые пользователи не отличит от «родных».